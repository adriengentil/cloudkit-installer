---
apiVersion: v1
kind: ConfigMap
metadata:
  name: webhook-config
  namespace: cloudkit
  labels:
    app.kubernetes.io/name: cloudkit-operator
    app.kubernetes.io/managed-by: kustomize
data:
  webhook-config.yaml: |
    webhooks:
      - name: cloudkit-validating-webhook
        type: validating
        port: 9443
        certDir: /tmp/k8s-webhook-server/serving-certs
        validation:
          enabled: true
          failurePolicy: Fail
          rules:
            - operations: ["CREATE", "UPDATE"]
              apiGroups: ["cloudkit.io"]
              apiVersions: ["v1alpha1"]
              resources: ["cloudkits"]
      - name: cloudkit-mutating-webhook
        type: mutating
        port: 9443
        certDir: /tmp/k8s-webhook-server/serving-certs
        mutation:
          enabled: true
          failurePolicy: Fail
          rules:
            - operations: ["CREATE", "UPDATE"]
              apiGroups: ["cloudkit.io"]
              apiVersions: ["v1alpha1"]
              resources: ["cloudkits"]
